---
layout: single
title: "DANNet: A One-Stage Domain Adaptation Network for Unsupervised Nighttime Semantic Segmentation"

excerpt : ""
categories: 
    - deeplearningCV #카테고리설정
tag: 
    - [] #테그

date: 2025-03-10
last_modified_at: 2025-03-10
classes: #wide    
---
[DANNet: A One-Stage Domain Adaptation Network for Unsupervised Nighttime Semantic Segmentation](https://arxiv.org/pdf/2104.10834){: .btn .btn--primary}


# Abstract

&nbsp;&nbsp; 야간 시간대 이미지에서의 Semantic segmentation은 자율주행에서 낮시간만큼 중요하지만, 저조도와 annotation의 어려움으로 인해 성능이 크게 저하된다. 이를 해결하기 위해 논문에서는 label이 있는 야간이미지 없이 사용할 수 있는 Domain adaptation network인 DANNet을 제안한다. 이 방법은 label이 존재하는 주간 이미지와 day-night pair가 존재하는 unlabeled dataset을 사용하여 adversarial 학습을 진행한다. 특히 unlabeled day-night image pair에서 pixel level의 예측을 정적 object category의 의사 감독으로 사용하여 야간 이미지를 분할한다. 
&nbsp;&nbsp; DANNet은 추가적인 이미지 변환 모델이 필요 없는 one-stage 모델이고, Image Alignment Subnetwork(IAS)를 통해 domain 차이를 줄이고, 가중치를 공유하고 adversarial 학습을 통해 야간 이미지 segmentation의 성능을 향상 시켰다.

# 1. Introduction
![Image5](/assets/images/DANNet/image1.jpg){: .align-center}
&nbsp;&nbsp; Semantic segmentation은 자율주행, medical image 등에서 중요한 역할을 하고 있다. 특히 자율주행과 같은 real time vision system에서는 야간에서 정확한 segmentation이 필수적이다. 그러나 야간에는 조명이 적고, 광원이 강하며 색상 변화, 블러 등으로 인해 그 성능이 떨어지는 모습을 보인다.
&nbsp;&nbsp; 또한 야간이미지에서는 위와 같은 이유들로 분별하기 어려운 위치들이 많이 있고, 사람이 annotation하는데 어려움을 준다. deep learning을 수행하기 위해서는 label이 필요한데, 이로 인해 딥러닝 학습에도 한계가 존재한다. 
&nbsp;&nbsp; 밤시간대의 segmentation의 어려움을 해결하기 위해 기존의 domain adaptation 방법은 CycleGAN과 같은 방법으로 야간 이미지를 주간 이미지로 변환하여 segmentation을 진행하였다. 그러나 이 방법에도 문제가 존재한다. 이미지 변환으로 인해 연산량이 증가하며, 변환 과정에서 semantic한 정보가 손실된다. 또한 아무리 완벽하게 이미지가 변환 되어도 원본과 동일한 semantic 정보를 유지하는 것이 어렵기 때문이다.
&nbsp;&nbsp; 논문에서는 DANNet을 제안하여 이 문제를 해결한다. 이 Network는 주, 야간 이미지 변환 과정 없이 야간이미지에서 직접 semantic segmentation을 수행하고, 가중치를 공유하고 adversarial 학습을 사용하며 GPS 정보를 통해 Dark Zurich dataset의 낮과 밤 이미지의 특징을 정렬한다. 또한 self-training으로 야간 데이터에 대한 추가적인 정보를 학습한다. 

# 2. Related work

## 2.1 Domain adaptation for semantic segmentation
&nbsp;&nbsp; 도메인 적응(Domain Adaptation)은 **Source Domain** 에서 학습된 모델을 **Target Domain** 에서도 효과적으로 적용할 수 있도록 학습하는 기법이다.
Semantic Segmentation에서는 **주간 이미지를 포함한 데이터셋(예: Cityscapes)**에서 학습된 모델을 야간 이미지 도메인에 적용하는 것이 목표이다. 주간과 야간은 **조명, 색상 분포, 텍스처 등의 차이로 인해 도메인 차이** 가 크기 때문에, 별도의 적응 과정이 필요하다.
&nbsp;&nbsp; Hoffman et al.【16】은 Fully Convolutional Network 기반 적대적 학습 기법을 활용하여 도메인 적응을 수행하는 방법을 제안했다. 이후, Tsai et al.【38】은 **Multi-Level Adversarial Network**를 제안안하여, **Output Space**에서 도메인 적응을 수행하는 방법을 제안했다. 이는 source 도메인과 target 도메인의 예측 결과를 정렬하여 모델이 도메인 차이를 줄일 수 있도록 유도한다.
&nbsp;&nbsp; 최근 연구에서는 Self-training 기법이 도메인 적응에 효과적임을 보였다
**Pseudo-label을 생성하여 점진적으로 모델을 Fine-tuning**하는 방식이다. DANNet에서도 이러한 자기 학습 기법을 일부 활용하여 야간 이미지에서의 의미론적 분할 성능을 향상시킨다.
